<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FC Köln International Talent Program</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .login-container { 
            background: white; 
            padding: 48px; 
            border-radius: 20px; 
            box-shadow: 0 25px 50px rgba(0,0,0,0.25); 
            width: 100%; 
            max-width: 420px; 
            position: relative;
            overflow: hidden;
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #dc2626, #ef4444, #dc2626);
        }
        
        .logo { 
            text-align: center; 
            color: #dc2626; 
            font-size: 32px; 
            font-weight: 800; 
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            text-align: center;
            color: #6b7280;
            margin-bottom: 40px;
            font-size: 16px;
            font-weight: 500;
        }
        
        .form-group { 
            margin-bottom: 24px; 
        }
        
        label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 600; 
            color: #374151;
            font-size: 14px;
        }
        
        input { 
            width: 100%; 
            padding: 16px 20px; 
            border: 2px solid #e5e7eb; 
            border-radius: 12px; 
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f9fafb;
        }
        
        input:focus { 
            outline: none; 
            border-color: #dc2626; 
            background: white;
            box-shadow: 0 0 0 4px rgba(220,38,38,0.1); 
        }
        
        .btn { 
            width: 100%; 
            padding: 16px; 
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white; 
            border: none; 
            border-radius: 12px; 
            font-size: 16px; 
            font-weight: 600; 
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn:hover { 
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(220,38,38,0.4);
        }
        
        .btn:active { 
            transform: translateY(0);
        }
        
        .btn:disabled { 
            background: #9ca3af; 
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .message { 
            margin-top: 24px; 
            padding: 16px; 
            border-radius: 12px; 
            font-weight: 500; 
            font-size: 14px;
            animation: slideIn 0.3s ease;
        }
        
        .success { 
            background: #d1fae5; 
            color: #065f46; 
            border: 1px solid #10b981; 
        }
        
        .error { 
            background: #fee2e2; 
            color: #991b1b; 
            border: 1px solid #ef4444; 
        }
        
        .status {
            margin-top: 24px;
            text-align: center;
            font-size: 14px;
            color: #6b7280;
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .loading {
            animation: pulse 1s infinite;
        }
        
        .credentials {
            margin-top: 20px;
            padding: 16px;
            background: #eff6ff;
            border-radius: 8px;
            border: 1px solid #dbeafe;
        }
        
        .credentials h4 {
            color: #1e40af;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .credentials p {
            color: #1e40af;
            font-size: 12px;
            margin: 4px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="logo">FC Köln Management</div>
        <div class="subtitle">International Talent Program</div>
        
        <form id="loginForm">
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" required placeholder="Enter your email" value="max.bisinger@warubi-sports.com">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" required placeholder="Enter your password" value="ITP2024">
            </div>
            <button type="submit" class="btn" id="submitBtn">Sign In</button>
        </form>
        
        <div id="message"></div>
        
        <div class="status">
            <div class="status-dot"></div>
            <span>System Ready | Deployment Optimized</span>
        </div>
        
        <div class="credentials">
            <h4>Available Credentials</h4>
            <p>Admin: max.bisinger@warubi-sports.com / ITP2024</p>
            <p>Staff: thomas.ellinger@warubi-sports.com / ITP2024</p>
        </div>
    </div>
    
    <script>
        // Check if we're in a server environment
        const isServerEnvironment = window.location.protocol === 'http:' || window.location.protocol === 'https:';
        
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const messageDiv = document.getElementById('message');
            const submitBtn = document.getElementById('submitBtn');
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Signing in...';
            submitBtn.classList.add('loading');
            messageDiv.innerHTML = '';
            
            try {
                if (isServerEnvironment) {
                    // Try to authenticate with server
                    const response = await fetch('/api/auth/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok && data.token) {
                        localStorage.setItem('auth-token', data.token);
                        messageDiv.innerHTML = '<div class="message success">Login successful! Welcome to FC Köln Management System.</div>';
                        
                        setTimeout(() => {
                            messageDiv.innerHTML = '<div class="message success">System authenticated. All features operational.</div>';
                        }, 1500);
                    } else {
                        messageDiv.innerHTML = '<div class="message error">' + (data.message || 'Login failed') + '</div>';
                    }
                } else {
                    // Fallback authentication for standalone file
                    const validCredentials = [
                        { email: 'max.bisinger@warubi-sports.com', password: 'ITP2024', name: 'Max Bisinger', role: 'admin' },
                        { email: 'thomas.ellinger@warubi-sports.com', password: 'ITP2024', name: 'Thomas Ellinger', role: 'staff' }
                    ];
                    
                    const user = validCredentials.find(cred => cred.email === email && cred.password === password);
                    
                    if (user) {
                        localStorage.setItem('auth-token', 'token_' + Date.now());
                        localStorage.setItem('user', JSON.stringify(user));
                        messageDiv.innerHTML = '<div class="message success">Login successful! Welcome ' + user.name + '.</div>';
                        
                        setTimeout(() => {
                            messageDiv.innerHTML = '<div class="message success">FC Köln Management System ready. All features available.</div>';
                        }, 1500);
                    } else {
                        messageDiv.innerHTML = '<div class="message error">Invalid credentials. Please check your email and password.</div>';
                    }
                }
                
            } catch (error) {
                // Fallback to local authentication if server is unreachable
                const validCredentials = [
                    { email: 'max.bisinger@warubi-sports.com', password: 'ITP2024', name: 'Max Bisinger', role: 'admin' },
                    { email: 'thomas.ellinger@warubi-sports.com', password: 'ITP2024', name: 'Thomas Ellinger', role: 'staff' }
                ];
                
                const user = validCredentials.find(cred => cred.email === email && cred.password === password);
                
                if (user) {
                    localStorage.setItem('auth-token', 'offline_token_' + Date.now());
                    localStorage.setItem('user', JSON.stringify(user));
                    messageDiv.innerHTML = '<div class="message success">Offline login successful! Welcome ' + user.name + '.</div>';
                } else {
                    messageDiv.innerHTML = '<div class="message error">Connection error and invalid credentials.</div>';
                }
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Sign In';
                submitBtn.classList.remove('loading');
            }
        });
        
        // Check for existing authentication
        const existingToken = localStorage.getItem('auth-token');
        const existingUser = localStorage.getItem('user');
        
        if (existingToken && existingUser) {
            try {
                const user = JSON.parse(existingUser);
                document.getElementById('message').innerHTML = '<div class="message success">Already authenticated as ' + user.name + '</div>';
            } catch (e) {
                localStorage.removeItem('auth-token');
                localStorage.removeItem('user');
            }
        }
    </script>
</body>
</html>